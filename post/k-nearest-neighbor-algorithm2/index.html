<!doctype html><html lang=zh-cn dir=content/zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=content-security-policy content="upgrade-insecure-requests"><title>k近邻算法--2.示例：使用k近邻算法改进约会网站的配对效果 - 奔赴下一场山海</title><meta name=keywords content="博客,程序员,架构师,思考,读书,笔记,技术,分享,大数据,产品"><meta name=author content="Murphy"><meta property="og:title" content="k近邻算法--2.示例：使用k近邻算法改进约会网站的配对效果"><meta property="og:site_name" content="奔赴下一场山海"><meta property="og:image" content="/img/author.jpg"><meta name=title content="k近邻算法--2.示例：使用k近邻算法改进约会网站的配对效果 - 奔赴下一场山海"><meta name=description content="欢迎来到Murphy的博客网站。"><link rel="shortcut icon" href=/img/favicon.ico><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link rel=apple-touch-icon-precomposed href=/img/apple-touch-icon.png><link href=//cdn.bootcdn.net/ajax/libs/font-awesome/4.6.2/css/font-awesome.min.css rel=stylesheet type=text/css><link href=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.css rel=stylesheet><link href=/css/main.css rel=stylesheet type=text/css><link href=/css/syntax.css rel=stylesheet type=text/css></head><body itemscope itemtype=http://schema.org/WebPage lang=zh-hans><div class="container one-collumn sidebar-position-left page-home"><div class=headband></div><header id=header class=header itemscope itemtype=http://schema.org/WPHeader><div class=header-inner><div class=site-brand-container><div class=site-nav-toggle><div class=toggle role=button style=opacity:1;top:0><span class=toggle-line></span>
<span class=toggle-line></span>
<span class=toggle-line></span></div></div><div class=site-meta><div class=multi-lang-switch><i class="fa fa-fw fa-language" style=margin-right:5px></i>
<a class=lang-link id=zh-cn href=#>中文</a></div><div class=custom-logo-site-title><a href=/ class=brand rel=start><span class=logo-line-before><i></i></span>
<span class=site-title>奔赴下一场山海</span>
<span class=logo-line-after><i></i></span></a></div><p class=site-subtitle>但远山长，云山乱，晓山青。</p></div><div class=site-nav-right><div class="toggle popup-trigger" style=opacity:1;top:0><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class=site-nav><ul id=menu class=menu><li class=menu-item><a href=/ rel=section><i class="menu-item-icon fa fa-fw fa-home"></i><br>首页</a></li><li class=menu-item><a href=/post rel=section><i class="menu-item-icon fa fa-fw fa-archive"></i><br>归档</a></li><li class=menu-item><a href=/about.html rel=section><i class="menu-item-icon fa fa-fw fa-user"></i><br>关于我</a></li><li class=menu-item><a href=/404.html rel=section><i class="menu-item-icon fa fa-fw fa-heartbeat"></i><br>公益404</a></li><li class="menu-item menu-item-search"><a href=javascript:; class=popup-trigger><i class="menu-item-icon fa fa-search fa-fw"></i><br>搜索</a></li></ul><div class=site-search><div class="popup search-popup local-search-popup"><div class="local-search-header clearfix"><span class=search-icon><i class="fa fa-search"></i></span>
<span class=popup-btn-close><i class="fa fa-times-circle"></i></span><div class=local-search-input-wrapper><input autocomplete=off placeholder=搜索关键字... spellcheck=false type=text id=local-search-input autocapitalize=none autocorrect=off></div></div><div id=local-search-result></div></div></div></nav></div></header><main id=main class=main><div class=main-inner><div class=content-wrap><div id=content class=content><section id=posts class=posts-expand><article class="post post-type-normal" itemscope itemtype=http://schema.org/Article><header class=post-header><h1 class=post-title itemprop="name headline"><a class=post-title-link href=https://murphyhanxu.github.io/post/k-nearest-neighbor-algorithm2/ itemprop=url>k近邻算法--2.示例：使用k近邻算法改进约会网站的配对效果</a></h1><div class=post-meta><span class=post-time><i class="fa fa-calendar-o fa-fw"></i>
<span class=post-meta-item-text>时间：</span>
<time itemprop=dateCreated datetime=2016-03-22T13:04:35+08:00 content="2022-08-10">2022-08-10</time></span>
<span class=post-category>&nbsp; | &nbsp;
<i class="fa fa-folder-o fa-fw"></i>
<span class=post-meta-item-text>分类：</span>
<span itemprop=about itemscope itemtype=https://schema.org/Thing><a href=/categories/cs itemprop=url rel=index style=text-decoration:underline><span itemprop=name>CS</span></a>
&nbsp;</span></span>
<span>|
<i class="fa fa-file-word-o fa-fw"></i>
<span class=post-meta-item-text>字数：</span>
<span class=leancloud-world-count>4860 字</span></span>
<span>|
<i class="fa fa-eye fa-fw"></i>
<span class=post-meta-item-text>阅读：</span>
<span class=leancloud-view-count>10分钟</span></span>
<span id=/post/k-nearest-neighbor-algorithm2/ class=leancloud_visitors data-flag-title=k近邻算法--2.示例：使用k近邻算法改进约会网站的配对效果>|
<i class="fa fa-binoculars fa-fw"></i>
<span class=post-meta-item-text>阅读次数：</span>
<span class=leancloud-visitors-count></span></span></div></header><div class=post-body itemprop=articleBody><h2 id=22--示例使用k近邻算法改进约会网站的配对效果>2.2 示例：使用k近邻算法改进约会网站的配对效果</h2><p>我的朋友海伦一直使用在线约会网站寻找适合自己的约会对象。尽管约会网站会推荐不同的人选，但她没有从中找到喜欢的人。经过一番总结，她发现曾交往过三种类型的人：(1)不喜欢的人、(2)魅力一般的人、(3)极具魅力的人。</p><p>尽管发现了上述规律，但海伦依然无法将约会网站推荐的匹配对象归入恰当的分类。她觉得可以在周一到周五约会那些魅力一般的人，而周末则更喜欢与那些极具魅力的人为伴。海伦希望我们的分类软件可以更好地帮助她将匹配对象划分到确切的分类中。此外海伦还收集了一些约会网站未曾记录的数据信息，她认为这些数据更有助于匹配对象的归类。</p><p>示例：在约会网站上使用k近邻算法</p><ol><li><p>收集数据：提供文本文件</p></li><li><p>准备数据：使用Python解析文本文件</p></li><li><p>分析数据：使用Matplotlib画二维扩散图</p></li><li><p>训练算法：此步骤不适用于k近邻算法</p></li><li><p>测试算法：使用海伦提供的部分数据作为测试样本。</p><p>测试样本和非测试样本的区别在于：测试样本是已经完成分类的数据，如果预测分类与实际类别不同，则标记为一个错误。</p></li><li><p>使用算法：产生简单的命令行程序，然后海伦可以输入一些特征数据以判断对方是否为自己喜欢的类型。</p></li></ol><h3 id=21--准备数据从文本文件中解析数据>2.1 准备数据：从文本文件中解析数据</h3><p>海伦收集约会数据已经有了一段时间，她把这些数据存放在文本文件datingTextSet.txt中，每个样本数据占据一行，总共有1k行。海伦的样本主要包含一下三种特征：</p><ul><li>每年获得的飞行常客里程数</li><li>玩视频游戏所耗时间百分比</li><li>每周消费的冰淇淋公升数</li></ul><p>在将上述特征数据输入到分类器之前，必须将待处理数据的格式改变为分类器可以接收的格式。将结果类型(1)不喜欢的人赋值为1，(2)魅力一般的人赋值为2，(3)极具魅力的人赋值为3。存放在文本文件datingTextSet2.txt中。</p><p>在kNN.py中创建名为file2matrix的函数，以此来处理输入格式问题。该函数的输入为文件名字符串，输出为训练样本矩阵和类标签向量。将下面的代码增加到kNN.py中：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#080;font-style:italic>#  程序清单2.1.1 将文本记录到转换NumPy的解析程序</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>file2matrix</span>(filename):
</span></span><span style=display:flex><span>    fr <span style=color:#666>=</span> <span style=color:#a2f>open</span>(filename)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic>#  ①得到文件行数</span>
</span></span><span style=display:flex><span>    numberOfLines <span style=color:#666>=</span> <span style=color:#a2f>len</span>(fr<span style=color:#666>.</span>readlines())
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic>#  ②创建返回的NumPy矩阵</span>
</span></span><span style=display:flex><span>    returnMat <span style=color:#666>=</span> zeros((numberOfLines,<span style=color:#666>3</span>))
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic>#  ③解析文件数据到列表</span>
</span></span><span style=display:flex><span>    classLabelVector <span style=color:#666>=</span> []
</span></span><span style=display:flex><span>    fr <span style=color:#666>=</span> <span style=color:#a2f>open</span>(filename)
</span></span><span style=display:flex><span>    index <span style=color:#666>=</span> <span style=color:#666>0</span>
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>for</span> line <span style=color:#a2f;font-weight:700>in</span> fr<span style=color:#666>.</span>readlines():
</span></span><span style=display:flex><span>        line <span style=color:#666>=</span> line<span style=color:#666>.</span>strip()
</span></span><span style=display:flex><span>        listFromLine <span style=color:#666>=</span> line<span style=color:#666>.</span>split(<span style=color:#b44>&#39;</span><span style=color:#b62;font-weight:700>\t</span><span style=color:#b44>&#39;</span>)
</span></span><span style=display:flex><span>        returnMat[index,:] <span style=color:#666>=</span> listFromLine[<span style=color:#666>0</span>:<span style=color:#666>3</span>]
</span></span><span style=display:flex><span>        classLabelVector<span style=color:#666>.</span>append(<span style=color:#a2f>int</span>(listFromLine[<span style=color:#666>-</span><span style=color:#666>1</span>]))
</span></span><span style=display:flex><span>        index <span style=color:#666>+=</span> <span style=color:#666>1</span>
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>return</span> returnMat, classLabelVector
</span></span></code></pre></div><p>从上面的代码可以看到，Python处理文本文件非常容易。首先我们需要知道文本文件包含多少行。打开文件，得到文件的行数①。然后创建以零填充的矩阵NumPy②。为了简化处理，我们将该矩阵的另一维度设置为固定值3，你可以按照自己的实际需求增加相应的代码以适应变化的输入值。循环处理文件中的每行数据③，首先使用函数line.strip()截取掉所有的回车字符，然后使用tab字符\t将上一步得到的整行数据分割成一个元素列表。接着，我们选取前3个元素，将它们存储到特征矩阵中。Python语言可以使用索引值-1表示列表中的最后一个元素。需要注意的是，我们必须明确地通知解释器，告诉它列表中存储的元素值为整型，否则Python语言会将这些元素当做字符串处理。以前我们必须自己处理这些变量值类型问题，现在这些细节问题完全可以交给NumPy函数库来处理。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#666>&gt;&gt;&gt;</span>datingDataMat, datingLabels <span style=color:#666>=</span> kNN<span style=color:#666>.</span>file2matrix(<span style=color:#b44>&#39;./datingTestSet.txt&#39;</span>)
</span></span></code></pre></div><p>使用函数file2matrix读取文件数据，必须确保文件datingTestSet.txt存储在我们的工作目录中。现在已经从文本文件中导入了数据，并将其格式化为想要的格式，接着我们需要了解数据的真实含义。当然我们可以直接浏览文本文件，但一般来说，我们会采用图形化的方式直观地展示数据。</p><h3 id=22--分析数据使用matplotlib创建散点图>2.2 分析数据：使用Matplotlib创建散点图</h3><p>首先我们使用Matplotlib制作原始数据的散点图，在Python命令行环境中，输入下列命令:</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>matplotlib.pyplot</span> <span style=color:#a2f;font-weight:700>as</span> <span style=color:#00f;font-weight:700>plt</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>matplotlib</span> <span style=color:#a2f;font-weight:700>import</span> font_manager  <span style=color:#080;font-style:italic># 导入字体管理模块</span>
</span></span><span style=display:flex><span>datingDataMat, datingLabels <span style=color:#666>=</span> file2matrix(<span style=color:#b44>r</span><span style=color:#b44>&#39;./datingTestSet.txt&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># print(datingDataMat)</span>
</span></span><span style=display:flex><span><span style=color:#080;font-style:italic># print(datingLabels)</span>
</span></span><span style=display:flex><span>fig <span style=color:#666>=</span> plt<span style=color:#666>.</span>figure()
</span></span><span style=display:flex><span>ax <span style=color:#666>=</span> fig<span style=color:#666>.</span>add_subplot(<span style=color:#666>111</span>)
</span></span><span style=display:flex><span>ax<span style=color:#666>.</span>scatter(datingDataMat[:, <span style=color:#666>1</span>], datingDataMat[:, <span style=color:#666>2</span>])
</span></span><span style=display:flex><span>my_font <span style=color:#666>=</span> font_manager<span style=color:#666>.</span>FontProperties(fname<span style=color:#666>=</span><span style=color:#b44>r</span><span style=color:#b44>&#34;C:/WINDOWS/Fonts/simfang.ttf&#34;</span>)
</span></span><span style=display:flex><span>plt<span style=color:#666>.</span>xlabel(<span style=color:#b44>&#34;玩视频游戏所耗时间百分比&#34;</span>, fontproperties <span style=color:#666>=</span> my_font)
</span></span><span style=display:flex><span>plt<span style=color:#666>.</span>ylabel(<span style=color:#b44>&#34;每周消费的冰淇淋公升数&#34;</span>, fontproperties <span style=color:#666>=</span> my_font)
</span></span><span style=display:flex><span>plt<span style=color:#666>.</span>show()
</span></span></code></pre></div><p>输出效果如下图所示，散点图使用datingDataMat矩阵的第二、第三列数据，分别表示特征值“玩视频游戏所耗时间百分比”和“每周所消费的冰淇淋公升数”。</p><p><img src=https://MurphyHanxu.github.io/blogs-images/images/K-nearest-neighbor-algorithm2.1.png alt=K-nearest-neighbor-algorithm2.1></p><p>由于没有使用样本分类的特征值，我们很难从上图中看到任何有用的数据模式信息。一般来说，我们会采用色彩或其他的记号来标记不用样本分类，以便更好地理解数据信息。重新输入上面的代码，更改scatter函数：</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>showdatas</span>(datingDataMat, datingLabels):
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>from</span> <span style=color:#00f;font-weight:700>matplotlib.font_manager</span> <span style=color:#a2f;font-weight:700>import</span> FontProperties
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>matplotlib.lines</span> <span style=color:#a2f;font-weight:700>as</span> <span style=color:#00f;font-weight:700>mlines</span>
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>import</span> <span style=color:#00f;font-weight:700>matplotlib.pyplot</span> <span style=color:#a2f;font-weight:700>as</span> <span style=color:#00f;font-weight:700>plt</span>
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 设置汉字格式</span>
</span></span><span style=display:flex><span>    font <span style=color:#666>=</span> FontProperties(fname<span style=color:#666>=</span><span style=color:#b44>r</span><span style=color:#b44>&#34;c:\windows\fonts\simsun.ttc&#34;</span>, size<span style=color:#666>=</span><span style=color:#666>14</span>)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 将fig画布分隔成1行1列,不共享x轴和y轴,fig画布的大小为(13,8)</span>
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 当nrow=2,nclos=2时,代表fig画布被分为四个区域,axs[0][0]表示第一行第一个区域</span>
</span></span><span style=display:flex><span>    fig, axs <span style=color:#666>=</span> plt<span style=color:#666>.</span>subplots(nrows<span style=color:#666>=</span><span style=color:#666>2</span>, ncols<span style=color:#666>=</span><span style=color:#666>2</span>, sharex<span style=color:#666>=</span><span style=color:#a2f;font-weight:700>False</span>, sharey<span style=color:#666>=</span><span style=color:#a2f;font-weight:700>False</span>, figsize<span style=color:#666>=</span>(<span style=color:#666>13</span>, <span style=color:#666>8</span>))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    numberOfLabels <span style=color:#666>=</span> <span style=color:#a2f>len</span>(datingLabels)
</span></span><span style=display:flex><span>    LabelsColors <span style=color:#666>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>for</span> i <span style=color:#a2f;font-weight:700>in</span> datingLabels:
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>if</span> i <span style=color:#666>==</span> <span style=color:#666>1</span>:
</span></span><span style=display:flex><span>            LabelsColors<span style=color:#666>.</span>append(<span style=color:#b44>&#39;black&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>if</span> i <span style=color:#666>==</span> <span style=color:#666>2</span>:
</span></span><span style=display:flex><span>            LabelsColors<span style=color:#666>.</span>append(<span style=color:#b44>&#39;orange&#39;</span>)
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>if</span> i <span style=color:#666>==</span> <span style=color:#666>3</span>:
</span></span><span style=display:flex><span>            LabelsColors<span style=color:#666>.</span>append(<span style=color:#b44>&#39;red&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 画出散点图,以datingDataMat矩阵的第一(飞行常客例程)、第二列(玩游戏)数据画散点数据,散点大小为15,透明度为0.5</span>
</span></span><span style=display:flex><span>    axs[<span style=color:#666>0</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>scatter(x<span style=color:#666>=</span>datingDataMat[:, <span style=color:#666>0</span>], y<span style=color:#666>=</span>datingDataMat[:, <span style=color:#666>1</span>], color<span style=color:#666>=</span>LabelsColors, s<span style=color:#666>=</span><span style=color:#666>15</span>, alpha<span style=color:#666>=</span><span style=color:#666>.5</span>)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 设置标题,x轴label,y轴label</span>
</span></span><span style=display:flex><span>    axs0_title_text <span style=color:#666>=</span> axs[<span style=color:#666>0</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>set_title(<span style=color:#b44>u</span><span style=color:#b44>&#39;每年获得的飞行常客里程数与玩视频游戏所消耗时间占比&#39;</span>, fontproperties<span style=color:#666>=</span>font)
</span></span><span style=display:flex><span>    axs0_xlabel_text <span style=color:#666>=</span> axs[<span style=color:#666>0</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>set_xlabel(<span style=color:#b44>u</span><span style=color:#b44>&#39;每年获得的飞行常客里程数&#39;</span>, fontproperties<span style=color:#666>=</span>font)
</span></span><span style=display:flex><span>    axs0_ylabel_text <span style=color:#666>=</span> axs[<span style=color:#666>0</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>set_ylabel(<span style=color:#b44>u</span><span style=color:#b44>&#39;玩视频游戏所消耗时间占&#39;</span>, fontproperties<span style=color:#666>=</span>font)
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>setp(axs0_title_text, size<span style=color:#666>=</span><span style=color:#666>9</span>, weight<span style=color:#666>=</span><span style=color:#b44>&#39;bold&#39;</span>, color<span style=color:#666>=</span><span style=color:#b44>&#39;red&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>setp(axs0_xlabel_text, size<span style=color:#666>=</span><span style=color:#666>7</span>, weight<span style=color:#666>=</span><span style=color:#b44>&#39;bold&#39;</span>, color<span style=color:#666>=</span><span style=color:#b44>&#39;black&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>setp(axs0_ylabel_text, size<span style=color:#666>=</span><span style=color:#666>7</span>, weight<span style=color:#666>=</span><span style=color:#b44>&#39;bold&#39;</span>, color<span style=color:#666>=</span><span style=color:#b44>&#39;black&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 画出散点图,以datingDataMat矩阵的第一(飞行常客例程)、第三列(冰激凌)数据画散点数据,散点大小为15,透明度为0.5</span>
</span></span><span style=display:flex><span>    axs[<span style=color:#666>0</span>][<span style=color:#666>1</span>]<span style=color:#666>.</span>scatter(x<span style=color:#666>=</span>datingDataMat[:, <span style=color:#666>0</span>], y<span style=color:#666>=</span>datingDataMat[:, <span style=color:#666>2</span>], color<span style=color:#666>=</span>LabelsColors, s<span style=color:#666>=</span><span style=color:#666>15</span>, alpha<span style=color:#666>=</span><span style=color:#666>.5</span>)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 设置标题,x轴label,y轴label</span>
</span></span><span style=display:flex><span>    axs1_title_text <span style=color:#666>=</span> axs[<span style=color:#666>0</span>][<span style=color:#666>1</span>]<span style=color:#666>.</span>set_title(<span style=color:#b44>u</span><span style=color:#b44>&#39;每年获得的飞行常客里程数与每周消费的冰激淋公升数&#39;</span>, fontproperties<span style=color:#666>=</span>font)
</span></span><span style=display:flex><span>    axs1_xlabel_text <span style=color:#666>=</span> axs[<span style=color:#666>0</span>][<span style=color:#666>1</span>]<span style=color:#666>.</span>set_xlabel(<span style=color:#b44>u</span><span style=color:#b44>&#39;每年获得的飞行常客里程数&#39;</span>, fontproperties<span style=color:#666>=</span>font)
</span></span><span style=display:flex><span>    axs1_ylabel_text <span style=color:#666>=</span> axs[<span style=color:#666>0</span>][<span style=color:#666>1</span>]<span style=color:#666>.</span>set_ylabel(<span style=color:#b44>u</span><span style=color:#b44>&#39;每周消费的冰激淋公升数&#39;</span>, fontproperties<span style=color:#666>=</span>font)
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>setp(axs1_title_text, size<span style=color:#666>=</span><span style=color:#666>9</span>, weight<span style=color:#666>=</span><span style=color:#b44>&#39;bold&#39;</span>, color<span style=color:#666>=</span><span style=color:#b44>&#39;red&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>setp(axs1_xlabel_text, size<span style=color:#666>=</span><span style=color:#666>7</span>, weight<span style=color:#666>=</span><span style=color:#b44>&#39;bold&#39;</span>, color<span style=color:#666>=</span><span style=color:#b44>&#39;black&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>setp(axs1_ylabel_text, size<span style=color:#666>=</span><span style=color:#666>7</span>, weight<span style=color:#666>=</span><span style=color:#b44>&#39;bold&#39;</span>, color<span style=color:#666>=</span><span style=color:#b44>&#39;black&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 画出散点图,以datingDataMat矩阵的第二(玩游戏)、第三列(冰激凌)数据画散点数据,散点大小为15,透明度为0.5</span>
</span></span><span style=display:flex><span>    axs[<span style=color:#666>1</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>scatter(x<span style=color:#666>=</span>datingDataMat[:, <span style=color:#666>1</span>], y<span style=color:#666>=</span>datingDataMat[:, <span style=color:#666>2</span>], color<span style=color:#666>=</span>LabelsColors, s<span style=color:#666>=</span><span style=color:#666>15</span>, alpha<span style=color:#666>=</span><span style=color:#666>.5</span>)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 设置标题,x轴label,y轴label</span>
</span></span><span style=display:flex><span>    axs2_title_text <span style=color:#666>=</span> axs[<span style=color:#666>1</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>set_title(<span style=color:#b44>u</span><span style=color:#b44>&#39;玩视频游戏所消耗时间占比与每周消费的冰激淋公升数&#39;</span>, fontproperties<span style=color:#666>=</span>font)
</span></span><span style=display:flex><span>    axs2_xlabel_text <span style=color:#666>=</span> axs[<span style=color:#666>1</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>set_xlabel(<span style=color:#b44>u</span><span style=color:#b44>&#39;玩视频游戏所消耗时间占比&#39;</span>, fontproperties<span style=color:#666>=</span>font)
</span></span><span style=display:flex><span>    axs2_ylabel_text <span style=color:#666>=</span> axs[<span style=color:#666>1</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>set_ylabel(<span style=color:#b44>u</span><span style=color:#b44>&#39;每周消费的冰激淋公升数&#39;</span>, fontproperties<span style=color:#666>=</span>font)
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>setp(axs2_title_text, size<span style=color:#666>=</span><span style=color:#666>9</span>, weight<span style=color:#666>=</span><span style=color:#b44>&#39;bold&#39;</span>, color<span style=color:#666>=</span><span style=color:#b44>&#39;red&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>setp(axs2_xlabel_text, size<span style=color:#666>=</span><span style=color:#666>7</span>, weight<span style=color:#666>=</span><span style=color:#b44>&#39;bold&#39;</span>, color<span style=color:#666>=</span><span style=color:#b44>&#39;black&#39;</span>)
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>setp(axs2_ylabel_text, size<span style=color:#666>=</span><span style=color:#666>7</span>, weight<span style=color:#666>=</span><span style=color:#b44>&#39;bold&#39;</span>, color<span style=color:#666>=</span><span style=color:#b44>&#39;black&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 设置图例</span>
</span></span><span style=display:flex><span>    didntLike <span style=color:#666>=</span> mlines<span style=color:#666>.</span>Line2D([], [], color<span style=color:#666>=</span><span style=color:#b44>&#39;black&#39;</span>, marker<span style=color:#666>=</span><span style=color:#b44>&#39;.&#39;</span>,
</span></span><span style=display:flex><span>                              markersize<span style=color:#666>=</span><span style=color:#666>6</span>, label<span style=color:#666>=</span><span style=color:#b44>&#39;didntLike&#39;</span>)
</span></span><span style=display:flex><span>    smallDoses <span style=color:#666>=</span> mlines<span style=color:#666>.</span>Line2D([], [], color<span style=color:#666>=</span><span style=color:#b44>&#39;orange&#39;</span>, marker<span style=color:#666>=</span><span style=color:#b44>&#39;.&#39;</span>,
</span></span><span style=display:flex><span>                               markersize<span style=color:#666>=</span><span style=color:#666>6</span>, label<span style=color:#666>=</span><span style=color:#b44>&#39;smallDoses&#39;</span>)
</span></span><span style=display:flex><span>    largeDoses <span style=color:#666>=</span> mlines<span style=color:#666>.</span>Line2D([], [], color<span style=color:#666>=</span><span style=color:#b44>&#39;red&#39;</span>, marker<span style=color:#666>=</span><span style=color:#b44>&#39;.&#39;</span>,
</span></span><span style=display:flex><span>                               markersize<span style=color:#666>=</span><span style=color:#666>6</span>, label<span style=color:#666>=</span><span style=color:#b44>&#39;largeDoses&#39;</span>)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 添加图例</span>
</span></span><span style=display:flex><span>    axs[<span style=color:#666>0</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>legend(handles<span style=color:#666>=</span>[didntLike, smallDoses, largeDoses])
</span></span><span style=display:flex><span>    axs[<span style=color:#666>0</span>][<span style=color:#666>1</span>]<span style=color:#666>.</span>legend(handles<span style=color:#666>=</span>[didntLike, smallDoses, largeDoses])
</span></span><span style=display:flex><span>    axs[<span style=color:#666>1</span>][<span style=color:#666>0</span>]<span style=color:#666>.</span>legend(handles<span style=color:#666>=</span>[didntLike, smallDoses, largeDoses])
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 显示图片</span>
</span></span><span style=display:flex><span>    plt<span style=color:#666>.</span>show()
</span></span></code></pre></div><p><img src=https://MurphyHanxu.github.io/blogs-images/images/K-nearest-neighbor-algorithm2.2.png alt=K-nearest-neighbor-algorithm2.2></p><p>由于利用颜色和尺寸标识了数据点的属性类别，因而我们基本上可以从上图看到数据点所属三个样本分类的区域轮廓。</p><h3 id=23--准备数据归一化数值>2.3 准备数据：归一化数值</h3><p><img src=https://MurphyHanxu.github.io/blogs-images/images/K-nearest-neighbor-algorithm2.3.png alt=K-nearest-neighbor-algorithm2.3></p><p>我们很容易发现，数值插值大的属性对计算结果影响很大，也就是说，每年获取的飞行常客里程数对于计算结果的影响将远远大于其他两个特征的影响。而产生的这种现象的原因，仅仅是因为飞行常客里程数远大于其他特征值。但海伦认为这三种特征是同等重要的，因此作为三个等权重的特征之一，飞行常客里程数并不应该如此严重地影响到计算结果。</p><p>在处理不同取值范围的特征值时，我们通常采用的方法是将数值归一化，如将取值范围处理为0到1或-1到1之间。</p><p>我们需要在文件kNN.py中增加一个新函数autoNorm()，该函数可以自动将数字特征值转化为0到1的区间。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#080;font-style:italic>#  程序清单2.3.1 归一化特征值</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>autoNorm</span>(dataSet):
</span></span><span style=display:flex><span>    minVals <span style=color:#666>=</span> dataSet<span style=color:#666>.</span>min(<span style=color:#666>0</span>)
</span></span><span style=display:flex><span>    maxVals <span style=color:#666>=</span> dataSet<span style=color:#666>.</span>max(<span style=color:#666>0</span>)
</span></span><span style=display:flex><span>    ranges <span style=color:#666>=</span> maxVals <span style=color:#666>-</span> minVals
</span></span><span style=display:flex><span>    normDataSet <span style=color:#666>=</span> zeros(shape(dataSet))
</span></span><span style=display:flex><span>    m <span style=color:#666>=</span> dataSet<span style=color:#666>.</span>shape[<span style=color:#666>0</span>]
</span></span><span style=display:flex><span>    normDataSet <span style=color:#666>=</span> dataSet <span style=color:#666>-</span> tile(minVals, (m,<span style=color:#666>1</span>))
</span></span><span style=display:flex><span>    normDataSet <span style=color:#666>=</span> normDataSet<span style=color:#666>/</span>tile(ranges, (m,<span style=color:#666>1</span>))   <span style=color:#080;font-style:italic>#element wise divide</span>
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>return</span> normDataSet, ranges, minVals
</span></span></code></pre></div><p>在函数autoNorm()中，我们将每列的最小值放在变量minVals中，将最大值放在变量maxVals中，其中dataSet.min(0)中的参数0可以使得函数可以从列中选取最小值，而不是选取当前行的最小值。然后，函数计算可能的取值范围，并创建新的返回矩阵。需要注意的是，特征值矩阵有1000x3个值，而minVals和range的值都为1x3。为了解决这个问题，我们使用NumPy库中tile()函数将变量内容复制成输入矩阵同样大小的矩阵，注意这是具体特征值相除，而对于某些数值处理软件包，/可能意味着矩阵除法，但在NumPy库中，矩阵除法需要使用函数linalg.solve(matA, matB)。</p><h3 id=24--测试算法作为完整程序验证分类器>2.4 测试算法：作为完整程序验证分类器</h3><p>前面已经将数据按照需求进行了处理，本节我们将测试分类器的效果。如果分类器的正确率满足要求，海伦就可以使用这个软件来处理约会网站提供的约会名单了。机器学习算法一个很重要的工作就是评估算法的正确率，通常我们只提供已有数据的90%作为训练样本来训练分类器，而使用其余的10%数据去测试分类器，检测分类器的正确率。需要注意的是，10%测试数据应该是随机选择的，由于海伦提供的数据并没有按照特定目的来排序，所以我们可以随意选择10%数据而不影响其随机性。</p><p>前面我们已经提到可以使用错误率来检测分类器的性能。对于分类器来说，错误率就是分类器给出错误结果的次数除以测试数据的总数，完美分类器的错误率为0，而错误率为1的分类器不会给出任何正确的分类结果。代码里我们定义一个计数器变量，每次分类器错误地分类数据，计数器就加1，程序执行完成之后计数器的结果除以数据点总数即是错误率。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#080;font-style:italic>#  程序清单2.4.1 分类器针对约会网站的测试代码</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>datingClassTest</span>():
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 打开的文件名</span>
</span></span><span style=display:flex><span>    filename <span style=color:#666>=</span> <span style=color:#b44>&#34;./datingTestSet.txt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 将返回的特征矩阵和分类向量分别存储到datingDataMat和datingLabels中</span>
</span></span><span style=display:flex><span>    datingDataMat, datingLabels <span style=color:#666>=</span> file2matrix(filename)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 取所有数据的百分之十</span>
</span></span><span style=display:flex><span>    hoRatio <span style=color:#666>=</span> <span style=color:#666>0.10</span>
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 数据归一化,返回归一化后的矩阵,数据范围,数据最小值</span>
</span></span><span style=display:flex><span>    normMat, ranges, minVals <span style=color:#666>=</span> autoNorm(datingDataMat)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 获得normMat的行数</span>
</span></span><span style=display:flex><span>    m <span style=color:#666>=</span> normMat<span style=color:#666>.</span>shape[<span style=color:#666>0</span>]
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 百分之十的测试数据的个数</span>
</span></span><span style=display:flex><span>    numTestVecs <span style=color:#666>=</span> <span style=color:#a2f>int</span>(m <span style=color:#666>*</span> hoRatio)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 分类错误计数</span>
</span></span><span style=display:flex><span>    errorCount <span style=color:#666>=</span> <span style=color:#666>0.0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#a2f;font-weight:700>for</span> i <span style=color:#a2f;font-weight:700>in</span> <span style=color:#a2f>range</span>(numTestVecs):
</span></span><span style=display:flex><span>        <span style=color:#080;font-style:italic># 前numTestVecs个数据作为测试集,后m-numTestVecs个数据作为训练集</span>
</span></span><span style=display:flex><span>        classifierResult <span style=color:#666>=</span> classify0(normMat[i,:], normMat[numTestVecs:m,:],
</span></span><span style=display:flex><span>            datingLabels[numTestVecs:m], <span style=color:#666>4</span>)
</span></span><span style=display:flex><span>        <span style=color:#a2f>print</span>(<span style=color:#b44>&#34;分类结果:</span><span style=color:#b68;font-weight:700>%d</span><span style=color:#b62;font-weight:700>\t</span><span style=color:#b44>真实类别:</span><span style=color:#b68;font-weight:700>%d</span><span style=color:#b44>&#34;</span> <span style=color:#666>%</span> (classifierResult, datingLabels[i]))
</span></span><span style=display:flex><span>        <span style=color:#a2f;font-weight:700>if</span> classifierResult <span style=color:#666>!=</span> datingLabels[i]:
</span></span><span style=display:flex><span>            errorCount <span style=color:#666>+=</span> <span style=color:#666>1.0</span>
</span></span><span style=display:flex><span>    <span style=color:#a2f>print</span>(<span style=color:#b44>&#34;错误率:</span><span style=color:#b68;font-weight:700>%f%%</span><span style=color:#b44>&#34;</span> <span style=color:#666>%</span>(errorCount<span style=color:#666>/</span><span style=color:#a2f>float</span>(numTestVecs)<span style=color:#666>*</span><span style=color:#666>100</span>))
</span></span></code></pre></div><p>datingClassTest()首先使用了file2matrix()和autoNorm()函数从文件中读取数据并将其转换为归一化特征值。接着计算测试向量的数量，此步决定了normMat向量中哪些数据用于测试，哪些数据用于分类器的训练样本；然后将这两部分数据输入到原始kNN分类器函数classify0。最后，函数计算错误率并输出结果。我们可以改变函数datingClassTest()内变量hoRatio和变量k的值，检测错误率是否随着变量值的变化而增加。依赖于分类算法、数据集和程序设置，分类器的输出结果可能有很大的不同。</p><h3 id=25--使用算法构建完整可用系统>2.5 使用算法：构建完整可用系统</h3><p>前面我们已经在数据上对分类器进行了测试，现在终于可以使用这个分类器为海伦来对人们分类。我们会给海伦一小段程序，通过该程序海伦会在约会网站上找到某个人并输入他的信息，程序会给出她对对方喜欢程度的预测值。</p><div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#080;font-style:italic>#  程序清单2.5.1  约会网站预测函数</span>
</span></span><span style=display:flex><span><span style=color:#a2f;font-weight:700>def</span> <span style=color:#00a000>classifyPerson</span>():
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 输出结果</span>
</span></span><span style=display:flex><span>    resultList <span style=color:#666>=</span> [<span style=color:#b44>&#39;讨厌&#39;</span>,<span style=color:#b44>&#39;有些喜欢&#39;</span>,<span style=color:#b44>&#39;非常喜欢&#39;</span>]
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 三维特征用户输入</span>
</span></span><span style=display:flex><span>    precentTats <span style=color:#666>=</span> <span style=color:#a2f>float</span>(<span style=color:#a2f>input</span>(<span style=color:#b44>&#34;玩视频游戏所耗时间百分比:&#34;</span>))
</span></span><span style=display:flex><span>    ffMiles <span style=color:#666>=</span> <span style=color:#a2f>float</span>(<span style=color:#a2f>input</span>(<span style=color:#b44>&#34;每年获得的飞行常客里程数:&#34;</span>))
</span></span><span style=display:flex><span>    iceCream <span style=color:#666>=</span> <span style=color:#a2f>float</span>(<span style=color:#a2f>input</span>(<span style=color:#b44>&#34;每周消费的冰激淋公升数:&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 打开的文件名</span>
</span></span><span style=display:flex><span>    filename <span style=color:#666>=</span> <span style=color:#b44>&#34;datingTestSet.txt&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 打开并处理数据</span>
</span></span><span style=display:flex><span>    datingDataMat, datingLabels <span style=color:#666>=</span> file2matrix(filename)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 训练集归一化</span>
</span></span><span style=display:flex><span>    normMat, ranges, minVals <span style=color:#666>=</span> autoNorm(datingDataMat)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 生成NumPy数组,测试集</span>
</span></span><span style=display:flex><span>    inArr <span style=color:#666>=</span> np<span style=color:#666>.</span>array([precentTats, ffMiles, iceCream])
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 测试集归一化</span>
</span></span><span style=display:flex><span>    norminArr <span style=color:#666>=</span> (inArr <span style=color:#666>-</span> minVals) <span style=color:#666>/</span> ranges
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 返回分类结果</span>
</span></span><span style=display:flex><span>    classifierResult <span style=color:#666>=</span> classify0(norminArr, normMat, datingLabels, <span style=color:#666>3</span>)
</span></span><span style=display:flex><span>    <span style=color:#080;font-style:italic># 打印结果</span>
</span></span><span style=display:flex><span>    <span style=color:#a2f>print</span>(<span style=color:#b44>&#34;你可能</span><span style=color:#b68;font-weight:700>%s</span><span style=color:#b44>这个人&#34;</span> <span style=color:#666>%</span> (resultList[classifierResult<span style=color:#666>-</span><span style=color:#666>1</span>]))
</span></span></code></pre></div><p>接着我们只需输入数据，海伦即可得到预测结果。</p><p><img src=https://MurphyHanxu.github.io/blogs-images/images/K-nearest-neighbor-algorithm2.4.png alt=K-nearest-neighbor-algorithm2.4></p></div><footer class=post-footer><div class=post-tags><a href=/tags/machine-learning rel=tag title="Machine Learning">#Machine Learning#</a></div><div class=addthis_inline_share_toolbox></div><div class=post-nav><div class=article-copyright><div class=article-copyright-img><img src=/img/qq_qrcode.jpg width=129px height=129px><div style=text-align:center>QQ扫一扫交流</div></div><div class=article-copyright-info><p><span>声明：</span>k近邻算法--2.示例：使用k近邻算法改进约会网站的配对效果</p><p><span>链接：</span>https://murphyhanxu.github.io/post/k-nearest-neighbor-algorithm2/</p><p><span>作者：</span>Murphy</p><p><span>声明： </span>本博客文章除特别声明外，均采用 <a href=https://creativecommons.org/licenses/by-nc-sa/3.0/ target=_blank style=text-decoration:underline>CC BY-NC-SA 3.0</a>许可协议，转载请注明出处！</p></div></div><div class=clear></div></div><div class=reward-qr-info><div>创作实属不易，如有帮助，那就打赏博主些许茶钱吧 ^_^</div><button id=rewardButton disable=enable onclick='var qr=document.getElementById("QR");qr.style.display==="none"?qr.style.display="block":qr.style.display="none"'>
<span>赏</span></button><div id=QR style=display:none><div id=wechat style=display:inline-block><img id=wechat_qr src=/img/wechat-pay.png alt="WeChat Pay"><p>微信打赏</p></div></div></div><div class=post-nav><div class="post-nav-next post-nav-item"><a href=https://murphyhanxu.github.io/post/dide3.2_notes/ rel=next title="DIDL3.2 Notes"><i class="fa fa-chevron-left"></i> DIDL3.2 Notes</a></div><div class="post-nav-prev post-nav-item"><a href=https://murphyhanxu.github.io/post/k-nearest-neighbor-algorithm1/ rel=prev title=k近邻算法--1.k近邻算法概述>k近邻算法--1.k近邻算法概述
<i class="fa fa-chevron-right"></i></a></div></div><div id=wcomments></div></footer></article></section></div></div><div class=sidebar-toggle><div class=sidebar-toggle-line-wrap><span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
<span class="sidebar-toggle-line sidebar-toggle-line-last"></span></div></div><aside id=sidebar class=sidebar><div class=sidebar-inner><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc sidebar-nav-active" data-target=post-toc-wrap>文章目录</li><li class=sidebar-nav-overview data-target=site-overview>站点概览</li></ul><section class="site-overview sidebar-panel"><div class="site-author motion-element" itemprop=author itemscope itemtype=http://schema.org/Person><img class=site-author-image itemprop=image src=/img/avatar.png alt=Murphy><p class=site-author-name itemprop=name>Murphy</p><p class="site-description motion-element" itemprop=description>谁的脸谁的姓名</p></div><nav class="site-state motion-element"><div class="site-state-item site-state-posts"><a href=/post/><span class=site-state-item-count>17</span>
<span class=site-state-item-name>日志</span></a></div><div class="site-state-item site-state-categories"><a href=/categories/><span class=site-state-item-count>1</span>
<span class=site-state-item-name>分类</span></a></div><div class="site-state-item site-state-tags"><a href=/tags/><span class=site-state-item-count>8</span>
<span class=site-state-item-name>标签</span></a></div></nav><div class="links-of-author motion-element"><span class=links-of-author-item><a href=https://github.com/MurphyHanxu target=_blank title=GitHub><i class="fa fa-fw fa-github"></i>
GitHub</a></span></div><div class="links-of-blogroll motion-element links-of-blogroll-inline"><div class=links-of-blogroll-title><i class="fa fa-fw fa-globe"></i>
友情链接</div><ul class=links-of-blogroll-list><li class=links-of-blogroll-item><a href=https://www.liaoxuefeng.com/ title=廖雪峰 target=_blank>廖雪峰</a></li><li class=links-of-blogroll-item><a href=https://math.mickeylili.com/ title=Mickeylili target=_blank>Mickeylili</a></li></ul></div><div class="tagcloud-of-blogroll motion-element tagcloud-of-blogroll-inline"><div class=tagcloud-of-blogroll-title><i class="fa fa-fw fa-tags"></i>
标签云</div><ul class=tagcloud-of-blogroll-list><li class=tagcloud-of-blogroll-item><a href=/tags/machine-learning>Machine learning</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/github-pages>Github pages</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/python>Python</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/hugo>Hugo</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/sql>SQL</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/didl>Didl</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/homework>Homework</a></li><li class=tagcloud-of-blogroll-item><a href=/tags/mathematical-modeling>Mathematical modeling</a></li></ul></div></section><section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active"><div class=post-toc><div class=post-toc-content><nav id=TableOfContents><ul><li><a href=#22--示例使用k近邻算法改进约会网站的配对效果>2.2 示例：使用k近邻算法改进约会网站的配对效果</a><ul><li><a href=#21--准备数据从文本文件中解析数据>2.1 准备数据：从文本文件中解析数据</a></li><li><a href=#22--分析数据使用matplotlib创建散点图>2.2 分析数据：使用Matplotlib创建散点图</a></li><li><a href=#23--准备数据归一化数值>2.3 准备数据：归一化数值</a></li><li><a href=#24--测试算法作为完整程序验证分类器>2.4 测试算法：作为完整程序验证分类器</a></li><li><a href=#25--使用算法构建完整可用系统>2.5 使用算法：构建完整可用系统</a></li></ul></li></ul></nav></div></div></section></div></aside></div></main><footer id=footer class=footer><div class=footer-inner><div class=copyright><span class=copyright-year>&copy; 2010 - 2022</span>
<span class=with-love><i class="fa fa-heart"></i></span>
<span class=copyright-author>奔赴下一场山海</span></div></div></footer><div class=back-to-top><i class="fa fa-arrow-up"></i>
<span id=scrollpercent><span>0</span>%</span></div></div><script type=text/javascript src=//cdn.bootcdn.net/ajax/libs/jquery/2.1.4/jquery.min.js></script>
<script type=text/javascript src=/js/search.js></script>
<script type=text/javascript src=/js/affix.js></script>
<script type=text/javascript src=/js/scrollspy.js></script>
<script type=text/javascript>function detectIE(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),n=e.indexOf("Trident/"),s=e.indexOf("Edge/");return t>0||n>0||s>0?-1:1}function getCntViewHeight(){var t=$("#content").height(),e=$(window).height(),n=t>e?t-e:$(document).height()-e;return n}function getScrollbarWidth(){var e=$("<div />").addClass("scrollbar-measure").prependTo("body"),t=e[0],n=t.offsetWidth-t.clientWidth;return e.remove(),n}function registerBackTop(){var t=50,e=$(".back-to-top");$(window).on("scroll",function(){e.toggleClass("back-to-top-on",window.pageYOffset>t);var s=$(window).scrollTop(),o=getCntViewHeight(),i=s/o,n=Math.round(i*100),a=n>100?100:n;$("#scrollpercent>span").html(a)}),e.on("click",function(){$("html,body").animate({scrollTop:0,screenLeft:0},800)})}function initScrollSpy(){var e=".post-toc",s=$(e),t=".active-current";s.on("activate.bs.scrollspy",function(){var t=$(e+" .active").last();n(),t.addClass("active-current")}).on("clear.bs.scrollspy",n),$("body").scrollspy({target:e});function n(){$(e+" "+t).removeClass(t.substring(1))}}function initAffix(){var e=$(".header-inner").height(),t=parseInt($(".main").css("padding-bottom"),10),n=e+10;$(".sidebar-inner").affix({offset:{top:n,bottom:t}}),$(document).on("affixed.bs.affix",function(){updateTOCHeight(document.body.clientHeight-100)})}function initTOCDimension(){$(window).on("resize",function(){e&&clearTimeout(e),e=setTimeout(function(){var e=document.body.clientHeight-100;updateTOCHeight(e)},0)}),updateTOCHeight(document.body.clientHeight-100);var e,t=getScrollbarWidth();$(".post-toc").css("width","calc(100% + "+t+"px)")}function updateTOCHeight(e){e=e||"auto",$(".post-toc").css("max-height",e)}$(function(){var e,t,n,s,o=$(".header-inner").height()+10;$("#sidebar").css({'margin-top':o}).show(),t=parseInt($("#sidebar").css("margin-top")),n=parseInt($(".sidebar-inner").css("height")),e=t+n,s=$(".content-wrap").height(),s<e&&$(".content-wrap").css("min-height",e),$(".site-nav-toggle").on("click",function(){var e=$(".site-nav"),o=$(".toggle"),t="site-nav-on",i="toggle-close",n=e.hasClass(t),a=n?"slideUp":"slideDown",s=n?"removeClass":"addClass";e.stop()[a]("normal",function(){e[s](t),o[s](i)})}),registerBackTop(),initScrollSpy(),initAffix(),initTOCDimension(),$(".sidebar-nav-toc").click(function(){$(this).addClass("sidebar-nav-active"),$(this).next().removeClass("sidebar-nav-active"),$("."+$(this).next().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)}),$(".sidebar-nav-overview").click(function(){$(this).addClass("sidebar-nav-active"),$(this).prev().removeClass("sidebar-nav-active"),$("."+$(this).prev().attr("data-target")).toggle(500),$("."+$(this).attr("data-target")).toggle(500)})})</script><script src=//cdn.bootcdn.net/ajax/libs/imageviewer/0.1.0/viewer.min.js></script>
<script type=text/javascript>$(function(){$(".post-body").viewer()})</script><script type=text/javascript>$(function(){detectIE()>0?$.getScript(document.location.protocol+"//cdn.jsdelivr.net/npm/@waline/client/dist/Waline.min.js",function(){new Waline({el:"#wcomments",visitor:!0,avatar:"wavatar",avatarCDN:"https://sdn.geekzu.org/avatar/",avatarForce:!1,wordLimit:"200",placeholder:" 欢迎留下您的宝贵建议，请填写您的昵称和邮箱便于后续交流. ^_^ ",requiredFields:["nick","mail"],serverURL:"Your WalineSerURL",lang:"zh-cn"})}):$("#wcomments").html("抱歉，Waline插件不支持IE或Edge，建议使用Chrome浏览器。")})</script><script>MathJax={tex:{inlineMath:[["$","$"]]},displayMath:[["$$","$$"],["[[","]]"]],svg:{fontCache:"global"}}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script>
<script type=text/javascript src="//s7.addthis.com/js/300/addthis_widget.js#pubid=Your%20AddthisId"></script>
<script>(function(){var t,e=document.createElement("script"),n=window.location.protocol.split(":")[0];n==="https"?e.src="https://zz.bdstatic.com/linksubmit/push.js":e.src="http://push.zhanzhang.baidu.com/push.js",t=document.getElementsByTagName("script")[0],t.parentNode.insertBefore(e,t)})()</script></body></html>